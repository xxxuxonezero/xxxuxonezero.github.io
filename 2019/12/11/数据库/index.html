<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>数据库 | onezero</title><meta name="description" content="数据库概念DB：database 数据库。保存了一系列有组织的数据 DBMS：数据库管理系统。数据库通过DBMS创建和操作的容器（MySQL、Oracle、DB2、sqlserver) SQL:结构化查询语言，用于和DBMS通信，补充某个数据库软件特有的 MySQL服务的启动与停止     MySQL服务的登录   mysql [-h 主机名 -P 端口号] -u 用户名 -p（密码） MySQL"><meta name="keywords" content="MySQL,数据库"><meta name="author" content="xxxuxonezero"><meta name="copyright" content="xxxuxonezero"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="http://www.yelin.monster/pictures/favicon_.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="数据库"><meta name="twitter:description" content="数据库概念DB：database 数据库。保存了一系列有组织的数据 DBMS：数据库管理系统。数据库通过DBMS创建和操作的容器（MySQL、Oracle、DB2、sqlserver) SQL:结构化查询语言，用于和DBMS通信，补充某个数据库软件特有的 MySQL服务的启动与停止     MySQL服务的登录   mysql [-h 主机名 -P 端口号] -u 用户名 -p（密码） MySQL"><meta name="twitter:image" content="http://www.yelin.monster/pictures/mysql.jpg"><meta property="og:type" content="article"><meta property="og:title" content="数据库"><meta property="og:url" content="https://xxxuxonezero.github.io/2019/12/11/%E6%95%B0%E6%8D%AE%E5%BA%93/"><meta property="og:site_name" content="onezero"><meta property="og:description" content="数据库概念DB：database 数据库。保存了一系列有组织的数据 DBMS：数据库管理系统。数据库通过DBMS创建和操作的容器（MySQL、Oracle、DB2、sqlserver) SQL:结构化查询语言，用于和DBMS通信，补充某个数据库软件特有的 MySQL服务的启动与停止     MySQL服务的登录   mysql [-h 主机名 -P 端口号] -u 用户名 -p（密码） MySQL"><meta property="og:image" content="http://www.yelin.monster/pictures/mysql.jpg"><meta property="article:published_time" content="2019-12-11T13:18:30.000Z"><meta property="article:modified_time" content="2020-05-14T04:41:40.613Z"><link rel="manifest" href="manifest.json"/><meta name="theme-color" content="#fff"/><meta name="msapplication-TileColor" content="#fff"/><link rel="icon" type="image/png" sizes="32x32" href="/img/pwa/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/pwa/16.png"/><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://xxxuxonezero.github.io/2019/12/11/%E6%95%B0%E6%8D%AE%E5%BA%93/"><link rel="prev" title="v2ray出现can't bind to 127.0.0.1问题" href="https://xxxuxonezero.github.io/2020/05/13/127-0-0-1%E9%97%AE%E9%A2%98/"><link rel="next" title="机器学习——KNN分类算法" href="https://xxxuxonezero.github.io/2019/10/16/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94KNN%E5%88%86%E7%B1%BB%E7%AE%97%E6%B3%95/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"TSB6Y7HKWY","apiKey":"d2bde9906598de15745507a189b04307","indexName":"index","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: {"text":"I,LOVE,YOU","fontSize":"15px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/EXo9mSKU0AABu2E.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">31</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">27</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fa fa-book"></i><span> Book</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据库概念"><span class="toc-number">1.</span> <span class="toc-text">数据库概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL常见命令"><span class="toc-number">2.</span> <span class="toc-text">MySQL常见命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DQL语言（数据查询）"><span class="toc-number">3.</span> <span class="toc-text">DQL语言（数据查询）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#基础查询"><span class="toc-number">3.1.</span> <span class="toc-text">基础查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#排序查询"><span class="toc-number">3.2.</span> <span class="toc-text">排序查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#常见函数"><span class="toc-number">3.3.</span> <span class="toc-text">常见函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#单行函数"><span class="toc-number">3.3.1.</span> <span class="toc-text">单行函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#分组函数"><span class="toc-number">3.3.2.</span> <span class="toc-text">分组函数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#分组查询"><span class="toc-number">3.4.</span> <span class="toc-text">分组查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#连接查询（多表查询-多表连接）"><span class="toc-number">3.5.</span> <span class="toc-text">连接查询（多表查询&#x2F;多表连接）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#子查询（内查询）"><span class="toc-number">3.6.</span> <span class="toc-text">子查询（内查询）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#分页查询"><span class="toc-number">3.7.</span> <span class="toc-text">分页查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#联合查询（union"><span class="toc-number">3.8.</span> <span class="toc-text">联合查询（union)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DML语言（增删改）"><span class="toc-number">4.</span> <span class="toc-text">DML语言（增删改）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#插入语句"><span class="toc-number">4.1.</span> <span class="toc-text">插入语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#修改语句"><span class="toc-number">4.2.</span> <span class="toc-text">修改语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#删除语句"><span class="toc-number">4.3.</span> <span class="toc-text">删除语句</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DDL语言"><span class="toc-number">5.</span> <span class="toc-text">DDL语言</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#一、库的管理"><span class="toc-number">5.0.1.</span> <span class="toc-text">一、库的管理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#二、表的管理"><span class="toc-number">5.0.2.</span> <span class="toc-text">二、表的管理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据类型"><span class="toc-number">6.</span> <span class="toc-text">数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#整型"><span class="toc-number">6.0.1.</span> <span class="toc-text">整型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#小数"><span class="toc-number">6.0.2.</span> <span class="toc-text">小数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#时间"><span class="toc-number">6.0.3.</span> <span class="toc-text">时间</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常见约束"><span class="toc-number">7.</span> <span class="toc-text">常见约束</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#实例"><span class="toc-number"></span> <span class="toc-text">实例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#随机获取50条记录"><span class="toc-number">1.</span> <span class="toc-text">随机获取50条记录</span></a></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(http://www.yelin.monster/pictures/mysql.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">onezero</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fa fa-book"></i><span> Book</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">数据库</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2019-12-11 21:18:30"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-12-11</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-05-14 12:41:40"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-05-14</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>评论数:</span><a href="/2019/12/11/%E6%95%B0%E6%8D%AE%E5%BA%93/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/12/11/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="commentCount"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h3 id="数据库概念"><a href="#数据库概念" class="headerlink" title="数据库概念"></a>数据库概念</h3><p>DB：database 数据库。保存了一系列有组织的数据</p>
<p>DBMS：数据库管理系统。数据库通过DBMS创建和操作的容器（MySQL、Oracle、DB2、sqlserver)</p>
<p>SQL:结构化查询语言，用于和DBMS通信，补充某个数据库软件特有的</p>
<p>MySQL服务的启动与停止</p>
<img class="">

<img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="  http://www.yelin.monster/pictures/1572083329953.png"/>

<p>MySQL服务的登录</p>
<img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="  http://www.yelin.monster/pictures/1572083619138.png"/>

<p>mysql [-h 主机名 -P 端口号] -u 用户名 -p（密码）</p>
<h3 id="MySQL常见命令"><a href="#MySQL常见命令" class="headerlink" title="MySQL常见命令"></a>MySQL常见命令</h3><p>查看当前所有数据库：mysql&gt; show databases;<br>打开指定库：mysql&gt; use 库名;<br>查看当前库所有表：mysql&gt; show tables;</p>
<p>查看其他库所有表：mysql&gt; show tables from 库名</p>
<p>创建表：mysql&gt; create table 表名(<br>    -&gt; id int,<br>    -&gt; name varchar(20));</p>
<p>查看表结构：mysql&gt; desc 表名;</p>
<p>查看版本：select version();</p>
<h3 id="DQL语言（数据查询）"><a href="#DQL语言（数据查询）" class="headerlink" title="DQL语言（数据查询）"></a>DQL语言（数据查询）</h3><h4 id="基础查询"><a href="#基础查询" class="headerlink" title="基础查询"></a>基础查询</h4><p>select 查询列表 from 表名</p>
<ol>
<li><p><font color=red>查询列表可以使表中的字段、常量值、表达式、函数</font></p>
</li>
<li><p>查询结果是一个虚拟的表格</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">select last_name from employees;</span><br><span class="line">select * from employees;</span><br><span class="line"></span><br><span class="line">select 100;</span><br><span class="line">select 100%98;</span><br><span class="line">select version();</span><br><span class="line"></span><br><span class="line">#起别名，若别名有空格，则使用双引号引起来</span><br><span class="line">#1、用空格</span><br><span class="line">select 100%98 结果;</span><br><span class="line">#2、用as</span><br><span class="line">select last_name as 姓,first_name as 名 from employees;</span><br><span class="line"></span><br><span class="line">#distinct去重</span><br><span class="line">select distinct department_id from employees;</span><br><span class="line"></span><br><span class="line">#mysql中的+只是运算符，并不能拼接字符串</span><br><span class="line">#select &#39;123&#39;+90   尝试将字符型转为数值型，并作加法运算</span><br><span class="line">#213</span><br><span class="line">#select &#39;john&#39;+90	若不能转为数值型，则把字符型看作0</span><br><span class="line">#90</span><br><span class="line">select null+90	若有一方为null，则运算结果也为null</span><br><span class="line">#null</span><br><span class="line"></span><br><span class="line">#concat():字符串拼接</span><br><span class="line">select concat(last_name,&#39; &#39;,first_name) as name from employees;</span><br><span class="line"></span><br><span class="line">#ifnull(commission_pac,0):如果commission_pac为null，则输出0</span><br><span class="line">select ifnull(commission_pct,0) as 奖金,commission_pct from employees;</span><br></pre></td></tr></table></figure>

<img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="  http://www.yelin.monster/pictures/1572087965907.png"/>

<p>起别名：</p>
<ol>
<li>as</li>
<li>空格</li>
</ol>
<p>去重：distinct</p>
<p>+的作用：（只是运算符）</p>
<ol>
<li>数字+数字</li>
<li>字符+数字：尝试将字符转为数值进行加法，若不行，则是字符为0进行加法</li>
<li>null+数字：结果为null</li>
</ol>
<p>函数：</p>
<ul>
<li>concat():拼接字符串</li>
<li>ifnull():判断字段或表达式是否为null,若是，则返回指定的值，否则返回原本的值</li>
</ul>
<p>####条件查询</p>
<p>  select 查询列表 from 表名 where 筛选条件；</p>
<ul>
<li><p>按条件表达式（&gt;,&lt;=,&lt;&gt;,&gt;=,&lt;=)</p>
</li>
<li><p>按逻辑表达式（and ,or,not)</p>
</li>
<li><p>模糊查询（like,between and,in,is null，is not null)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">select * from employees where salary &gt; 12000;</span><br><span class="line">select first_name,department_id from employees where department_id &lt;&gt;90;</span><br><span class="line"></span><br><span class="line">select last_name,salary,commission_pct from employees where salary&gt;&#x3D;10000 and salary&lt;&#x3D;20000;</span><br><span class="line">select * from employees where not(department_id &gt;&#x3D;90 and department_id&lt;&#x3D;110) or salary&gt;20000;</span><br><span class="line"></span><br><span class="line">select * from employees where last_name like &#39;__n_l%&#39;</span><br><span class="line">#escape用于指定转义字符</span><br><span class="line">select last_name from employees where last_name like &#39;_$_%&#39; escape &#39;$&#39;</span><br><span class="line"></span><br><span class="line">select * from employees where job_id in(&#39;IT_PROG&#39;,&#39;AD_VP&#39;,&#39;AD_PRES&#39;)</span><br><span class="line">select * from employees where commission_pct is not null</span><br><span class="line"></span><br><span class="line">#安全等于&lt;&#x3D;&gt;</span><br><span class="line">select * from employees where commission_pct &lt;&#x3D;&gt; null</span><br></pre></td></tr></table></figure>

<p>通配符：</p>
<p>%：表示任意个数的字符</p>
<p>_:任意单个字符</p>
</li>
</ul>
<img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="  http://www.yelin.monster/pictures/1572088873895.png">

<p>  ==between and 包含临界值==</p>
<p>  ===不能用于判断null==</p>
<p>  is null 和 &lt;=&gt;的比较：<br>  is null 可读性高，is null 只可以判断null,&lt;=&gt;可以和普通类型的数值比较是否等于</p>
<p>  like 可以模糊匹配字符型数据，也可以是数值型</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  select * from employees;</span><br><span class="line">  select * from employees where commission_pct like &#39;%%&#39; and last_name like &#39;%%&#39;;</span><br><span class="line">  </span><br><span class="line">  试问：这两条语句的执行结果是否一样？</span><br><span class="line">答：不一样，因为commission_pct中含有null值，模糊查询没有办法查询出包含空值的记录</span><br></pre></td></tr></table></figure>



<h4 id="排序查询"><a href="#排序查询" class="headerlink" title="排序查询"></a>排序查询</h4><p>语法：select 【】 from 【】 （where 【】）  order by 【】</p>
<p>特点：</p>
<ol>
<li>asc：升序；desc:降序，默认是升序</li>
<li>order by子句中可以支持单个字段、多个字段、表达式、函数、别名</li>
<li>order by一般放在查询语句的最后面，limit子句除外</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">select * from employees order by salary desc;</span><br><span class="line">select * from employees order by salary;</span><br><span class="line"></span><br><span class="line">select * from employees where department_id &gt;&#x3D;90 order by hiredate;</span><br><span class="line"></span><br><span class="line">select * ,salary*12*ifnull(commission_pct,0) as 年薪 from employees </span><br><span class="line">order by salary*12*ifnull(commission_pct,0) desc;</span><br><span class="line">select * ,salary*12*ifnull(commission_pct,0) as 年薪 from employees </span><br><span class="line">order by 年薪 desc;</span><br><span class="line"></span><br><span class="line">#先按工资升序排，若一样按工号降序排</span><br><span class="line">select * from employees </span><br><span class="line">order by salary asc,employee_id desc</span><br></pre></td></tr></table></figure>



<h4 id="常见函数"><a href="#常见函数" class="headerlink" title="常见函数"></a>常见函数</h4><p>概念：类似于java中的方法</p>
<p>调用：select 函数名（实参列表） 【from 表】</p>
<p>分类：</p>
<ul>
<li>单行函数（concat(),llength())</li>
<li>分组函数（做统计使用）:又称聚合函数，统计函数、组函数</li>
</ul>
<h5 id="单行函数"><a href="#单行函数" class="headerlink" title="单行函数"></a>单行函数</h5><p>1、字符函数：</p>
<ul>
<li><p>length：获取字符的字节数（一个汉字3个字节）</p>
</li>
<li><p>concat：拼接字符串</p>
</li>
<li><p>upper,lower</p>
</li>
<li><p>substr,substring：截取从指定索引处指定长度的字符，索引从1开始</p>
</li>
</ul>
<p>如：select concat(upper(substr(last_name,1,1)),’_’,lower(substr(last_name,2))) output from employees;</p>
<ul>
<li><p>instr:返回子串第一次出现的起始索引，若不存在则返回0</p>
</li>
<li><p>trim:去除前后的指定字符，若不指定则默认为空格</p>
<p>​    select length(trim(‘       张翠山    ‘)) as output;<br>​    select trim(‘a’ from ‘aaaaaaaaaaa张aaaaaaaaaa翠山aaaaaaaaa’)</p>
</li>
<li><p>lpad:用指定的字符实现左填充指定长度</p>
<p>​    select lpad(‘殷素素’,9,’*’)</p>
</li>
<li><p>rpad</p>
</li>
<li><p>replace:替换    </p>
<p>​    replace(string,被替换的字符，用于替换的字符)：全部替换</p>
</li>
</ul>
<p>2、数学函数：</p>
<ul>
<li>round:四舍五入，默认得到的是整数    round(x)/round(x,小数点后保留的位数)</li>
<li>cell:向上取整，返回&gt;=该参数的最小整数</li>
<li>floor:向下取整，返回&lt;=该参数的最大整数</li>
<li>truncate:截断    truncate(x,小数点后的位数)</li>
<li>mod：取余</li>
<li>rand:获取随机数，0~1之间</li>
</ul>
<p>3、日期函数</p>
<ul>
<li><p>now():返回当前系统时间（日期+时间）</p>
</li>
<li><p>curdate():返回当前系统日期，不包含时间</p>
</li>
<li><p>curtime():当前时间，不包含日期</p>
<p>​    获取指定部分：年、月、日、小时、分钟、秒</p>
<p>​    year(时间),month(时间),day(时间)……</p>
</li>
<li><p>str_to_date:字符-&gt;日期    </p>
<p>​    select str_to_date(“09-13-1999”,”%m-%d-%Y”)    //1999-09-13</p>
</li>
<li><p>date_format:日期-&gt;字符    select date_format(now(),’%Y年%m月%d日’)</p>
<p>​    select last_name,date_format(hiredate,’%m月/%d日 %y年’) from employees </p>
<p>​    where commission_pct is not null;</p>
</li>
</ul>
<img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="  http://www.yelin.monster/pictures/1572182180347.png"/>



<p>4、其他函数</p>
<ul>
<li>select version()</li>
<li>select datebase()</li>
<li>select user()</li>
<li>select md5(‘字符‘）：返回md5加密形式</li>
</ul>
<p>5、流控制函数    </p>
<ul>
<li><p>if函数：相当于if…else…        </p>
<p>​    select if(10&lt;5,’小’,’大’)    //大</p>
</li>
<li><p>case函数：</p>
</li>
</ul>
<p>​    1、switch case（等值判断）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">case 要判断的字段或表达式</span><br><span class="line"></span><br><span class="line">when 常量1 then 要显示的值或语句</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">else 要显示的值n或语句</span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure>



<p>​    2、类似于多重if（区间判断）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">case </span><br><span class="line"></span><br><span class="line">when 条件1 then 值或语句</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">else 要显示的值n</span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>实践：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> salary 原始工资,department_id,</span><br><span class="line"><span class="keyword">case</span> department_id </span><br><span class="line"><span class="keyword">when</span> <span class="number">30</span> <span class="keyword">then</span> salary*<span class="number">1.1</span></span><br><span class="line"><span class="keyword">when</span> <span class="number">40</span> <span class="keyword">then</span> salary*<span class="number">1.2</span></span><br><span class="line"><span class="keyword">when</span> <span class="number">50</span> <span class="keyword">then</span> salary*<span class="number">1.3</span></span><br><span class="line"><span class="keyword">else</span> salary</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">as</span> 新工资</span><br><span class="line"><span class="keyword">from</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> salary,</span><br><span class="line"><span class="keyword">case</span></span><br><span class="line"><span class="keyword">when</span> salary&gt;<span class="number">20000</span> <span class="keyword">then</span> <span class="string">'A'</span></span><br><span class="line"><span class="keyword">when</span> salary&gt;<span class="number">15000</span> <span class="keyword">then</span> <span class="string">'B'</span></span><br><span class="line"><span class="keyword">else</span> <span class="string">'C'</span></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">as</span> <span class="keyword">level</span></span><br><span class="line"><span class="keyword">from</span> employees</span><br></pre></td></tr></table></figure>



<h5 id="分组函数"><a href="#分组函数" class="headerlink" title="分组函数"></a>分组函数</h5><ul>
<li>sum:求和</li>
<li>avg：平均值</li>
<li>max：最大值 </li>
<li>min：最小值</li>
<li>count：计算个数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select round(avg(salary),2),max(salary),min(salary),count(salary),sum(salary) from employees</span><br></pre></td></tr></table></figure>

<p><em>sum,avg处理数值型；min,max,count可以处理任何类型的值</em></p>
<p><em>分组函数都忽略null值</em></p>
<p><em>可以和distinct搭配</em></p>
<p> <code>select count(distinct salary) from employees</code></p>
<p><em>和分组函数一同查询的字段有限制，要求是group by后的字段，因为分组函数返回的是一个值</em></p>
<p>count详细解释：<br>count(*),count(1):个数为表中记录的个数</p>
<p>==一般使用count(*)计数==</p>
<p>计算最大入职日期和最小入职日期相差的天数</p>
<p><code>select datediff(max(hiredate),min(hiredate)) from employees</code></p>
<h4 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h4><p>语法：select 分组函数，列（要求出现在group by后面） from 表 【where 筛选条件】group by 分组的列表【order by 子句】</p>
<p>1、按表中单个字段分组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select max(salary),manager_id from employees</span><br><span class="line">where commission_pct is not null</span><br><span class="line">group by manager_id</span><br></pre></td></tr></table></figure>

<p>2、按表中多字段分组（必须满足这些字段完全一致才算是一组）</p>
<p><em>如何添加分组后的筛选条件？(利用having关键字，放在group by 后面)</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select count(*),department_id from employees</span><br><span class="line">group by department_id</span><br><span class="line">having count(*)&gt;2</span><br></pre></td></tr></table></figure>

<p>特点：</p>
<ul>
<li><p>分组查询中筛选条件分为两类：分组前筛选和分组后筛选</p>
<p>分组函数做条件一定是放在having子句中</p>
<p>能用分组前筛选的就优先使用分组前筛选，对性能有好处</p>
</li>
<li><p>支持单字段分组，多字段分组（多字段间用逗号隔开，无顺序要求），表达式或函数（用的较少）</p>
</li>
<li><p>也可以添加排序（放在分组查询的最末尾）</p>
</li>
</ul>
<h4 id="连接查询（多表查询-多表连接）"><a href="#连接查询（多表查询-多表连接）" class="headerlink" title="连接查询（多表查询/多表连接）"></a>连接查询（多表查询/多表连接）</h4><p>当查询字段来自多个表时，使用连接查询。</p>
<p>笛卡尔乘积现象：表1 有m行，表2 有n行，结果m*n行</p>
<p>发生原因：没有有效的连接条件</p>
<p>如何避免：添加有效的连接条件</p>
<p><code>select name,boyname from beauty,boys where beauty.boyfriend_id=boys.id;</code></p>
<p>按年代分类：</p>
<ul>
<li>sql92标准：仅支持内连接</li>
<li>sql99标准：支持内连接+外连接（左外+右外）+交叉连接</li>
</ul>
<p>按功能分类：</p>
<ul>
<li><p>内连接(sql92语法）</p>
<ul>
<li><p>等值连接</p>
<ol>
<li><p>多表等值连接的结果为多表的交集部分</p>
</li>
<li><p>n表的连接，至少要有n-1个连接条件</p>
</li>
<li><p>多表的顺序没有要求</p>
</li>
<li><p>一般要为表起别名</p>
</li>
</ol>
<p>·<code>select last_name,department_name,commission_pct 
from employees e,departments d
where commission_pct is not null
and e.department_id=d.department_id</code></p>
</li>
<li><p>非等值连接</p>
</li>
<li><p>自连接</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#7、选择指定员工的姓名，员工号，以及他的管理者的姓名和员工号，结果类似于下面的格式</span></span><br><span class="line">employees	Emp<span class="comment">#	manager	Mgr#</span></span><br><span class="line">kochhar		101	king	100</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> e1.last_name employees,e1.employee_id Emp,</span><br><span class="line">e2.last_name manager,e2.employee_id Mgr</span><br><span class="line"><span class="keyword">from</span> employees e1,employees e2</span><br><span class="line"><span class="keyword">where</span> e1.manager_id=e2.employee_id;</span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
<ul>
<li><p>外连接（分主、从表）</p>
<p>用于查询一个表中有另一个表中没有的记录</p>
<p>外连接查询结果为主表中的所有记录，如果从表中有和它匹配的，则显示匹配的值；否则显示null</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">sql99语法：select 查询列表</span><br><span class="line">	from 表1 别名 【连接类型】</span><br><span class="line">	join 表2 别名 </span><br><span class="line">	on 连接条件</span><br><span class="line">	【where 筛选条件】</span><br><span class="line">	【group by 分组】</span><br><span class="line">	【having 筛选条件】</span><br><span class="line">	【order by 排序列表】</span><br><span class="line">	</span><br><span class="line">	分类：</span><br><span class="line">内连接（★）：inner</span><br><span class="line">特点：</span><br><span class="line">①添加排序、分组、筛选</span><br><span class="line">②inner可以省略</span><br><span class="line">③ 筛选条件放在where后面，连接条件放在on后面，提高分离性，便于阅读</span><br><span class="line">④inner join连接和sql92语法中的等值连接效果是一样的，都是查询多表的交集</span><br><span class="line"></span><br><span class="line">外连接</span><br><span class="line">	左外(★):left 【outer】</span><br><span class="line">	右外(★)：right 【outer】</span><br><span class="line">	全外：full【outer】</span><br><span class="line">交叉连接：cross</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>左外连接</p>
<p>左边是主表</p>
</li>
<li><p>右外连接</p>
<p>右边是主表</p>
</li>
<li><p>全外连接（full outer join)</p>
<p>==mysql中无法使用全外连接==</p>
<p>全外连接=内连接的结果+表1中有但表2没有的+表2中有但表1没有的</p>
</li>
</ul>
<ul>
<li>交叉连接（cross join):笛卡尔乘积</li>
</ul>
<p>==如果为表起了别名，那么查询的字段就不可以用原来的表名去限定了。==</p>
<h4 id="子查询（内查询）"><a href="#子查询（内查询）" class="headerlink" title="子查询（内查询）"></a>子查询（内查询）</h4><blockquote>
<p>出现在其他语句中的select语句，称为子查询或内查询<br>外部的查询语句，称为主查询或外查询</p>
</blockquote>
<p>分类：</p>
<ul>
<li><p>按子查询位置：</p>
<ul>
<li><p>select后</p>
<p>仅支持标量子查询</p>
</li>
<li><p>from后</p>
<p>支持表子查询</p>
</li>
<li><p><em>where或having后</em></p>
<p>支持标量子查询（单行）、列子查询（多行）、行子查询</p>
<p>特点：</p>
<ol>
<li>子查询放在小括号内</li>
<li>子查询一般放在条件的右侧</li>
<li>标量子查询一般搭配着单行操作符使用（&gt; &lt; &gt;= &lt;= = &lt;&gt;)</li>
<li>列子查询一般搭配着多行操作符使用（in/not in,any/some,all)</li>
<li>子查询先于主查询执行</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#案例2：返回job_id与141号员工相同，salary比143号员工多的员工 姓名，job_id 和工资</span><br><span class="line">select last_name,job_id,salary</span><br><span class="line">from employees</span><br><span class="line">where job_id&#x3D;(select job_id from employees where employee_id&#x3D;141)</span><br><span class="line">and salary&gt;(select salary from employees where employee_id&#x3D;143);</span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
<ul>
<li><p>exists后（相关子查询）</p>
<p>支持表子查询</p>
<p>exists 用于判断子查询中是否有值，结果为1或0</p>
</li>
</ul>
<ul>
<li><p>按结果集行列数不同</p>
<ul>
<li>==标量子查询（结果集只有一行一列）==</li>
<li>==列子查询（结果集一列多行）==</li>
<li>行子查询（结果集一行多列）</li>
<li>表子查询（结果集一般多行多列）</li>
</ul>
</li>
</ul>
<h4 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h4><p>应用场景：要显示的数据一页显示不全， 需要分页提交sql请求。</p>
<p>特点：</p>
<ol>
<li>放在查询语句的最后</li>
<li>公式：limit (page-1)*size,size</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">语法：</span><br><span class="line">select 查询列表 from 表</span><br><span class="line">【join ..】 表2</span><br><span class="line">on 连接条件</span><br><span class="line">where </span><br><span class="line">group by</span><br><span class="line">having</span><br><span class="line">order by</span><br><span class="line">limit 起始索引（从0开始），要显示的条目个数</span><br></pre></td></tr></table></figure>





<h4 id="联合查询（union"><a href="#联合查询（union" class="headerlink" title="联合查询（union)"></a>联合查询（union)</h4><p>用处：将多条查询语句的结果合并成一个结果</p>
<p>应用场景：要查询的结果来自于多个表，且多个表没有直接的连接关系，但查询的信息一致</p>
<p>特点：</p>
<ol>
<li>多条查询语句的列数一致</li>
<li>要求多条查询语句的列的类型和顺序最好一致</li>
<li>会自动去重（union all 不会去重）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">语法：</span><br><span class="line">查询语句1</span><br><span class="line"> union</span><br><span class="line"> 查询语句2</span><br><span class="line"> union</span><br><span class="line"> ...</span><br></pre></td></tr></table></figure>



<h3 id="DML语言（增删改）"><a href="#DML语言（增删改）" class="headerlink" title="DML语言（增删改）"></a>DML语言（增删改）</h3><h4 id="插入语句"><a href="#插入语句" class="headerlink" title="插入语句"></a>插入语句</h4><ol>
<li>插入值的类型要与列的类型一致或兼容</li>
<li>不可以为null的列必须插入值，可以为null的可以省略其列名和对应的值</li>
<li>列的顺序可以调换</li>
<li>列数和值的个数必须一致</li>
<li>可以省略列名，默认是所有列，而且列的顺序和表的列顺序是一致的</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">语法一：</span><br><span class="line">insert into 表名(列名，...)</span><br><span class="line">values(值1，...)</span><br><span class="line"></span><br><span class="line">字符用单引号括起来</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">语法二：</span><br><span class="line">insert into 表名</span><br><span class="line">set 列名&#x3D;值，列名&#x3D;值。。。</span><br></pre></td></tr></table></figure>

<p>法一与法二的比较：</p>
<ol>
<li><p>法一支持插入多行，而法二不支持</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">insert into 表（）</span><br><span class="line">values(...),</span><br><span class="line">(...),</span><br><span class="line">(...)...</span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="2">
<li><p>法一支持子查询，而法二不支持</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">insert into beauty(name,phone)</span><br><span class="line">select name,&#39;4154165&#39;</span><br><span class="line">from boys</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h4 id="修改语句"><a href="#修改语句" class="headerlink" title="修改语句"></a>修改语句</h4><ol>
<li><p>修改单表记录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">update 表名</span><br><span class="line">set 列&#x3D;新值，列&#x3D;新值。。。</span><br><span class="line">where</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改多表记录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">语法：</span><br><span class="line">sql92语法：</span><br><span class="line">update 表1 别名,表2 别名</span><br><span class="line">set 列&#x3D;值,...</span><br><span class="line">where 连接条件</span><br><span class="line">and 筛选条件;</span><br><span class="line"></span><br><span class="line">sql99语法：</span><br><span class="line">update 表1 别名</span><br><span class="line">inner|left|right join 表2 别名</span><br><span class="line">on 连接条件</span><br><span class="line">set 列&#x3D;值,...</span><br><span class="line">where 筛选条件;</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h4 id="删除语句"><a href="#删除语句" class="headerlink" title="删除语句"></a>删除语句</h4><p>单表删除</p>
<p>一、delete</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from 表名 where 筛选条件</span><br></pre></td></tr></table></figure>

<p>二、truncate（表并未被删除，其中的数据全部清除）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">语法：truncate table 表名;</span><br></pre></td></tr></table></figure>

<p>多表删除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sql92语法：</span><br><span class="line">delete 表1的别名,表2的别名</span><br><span class="line">from 表1 别名,表2 别名</span><br><span class="line">where 连接条件</span><br><span class="line">and 筛选条件;</span><br><span class="line"></span><br><span class="line">sql99语法：</span><br><span class="line"></span><br><span class="line">delete 表1的别名,表2的别名</span><br><span class="line">from 表1 别名</span><br><span class="line">inner|left|right join 表2 别名 on 连接条件</span><br><span class="line">where 筛选条件;</span><br></pre></td></tr></table></figure>

<p>delete和truncate的比较：</p>
<ol>
<li>delete 可以加where 条件，truncate不能加</li>
<li>truncate删除，效率高一丢丢</li>
<li>假如要删除的表中有自增长列，<br>如果用delete删除后，再插入数据，自增长列的值从断点开始，<br>而truncate删除后，再插入数据，自增长列的值从1开始。</li>
<li>truncate删除没有返回值，delete删除有返回值</li>
<li>truncate删除不能回滚，delete删除可以回滚.</li>
</ol>
<h3 id="DDL语言"><a href="#DDL语言" class="headerlink" title="DDL语言"></a>DDL语言</h3><h5 id="一、库的管理"><a href="#一、库的管理" class="headerlink" title="一、库的管理"></a>一、库的管理</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#创建</span><br><span class="line">create database[if not exists] 库名;</span><br><span class="line">#修改</span><br><span class="line">rename database 库名 to 新库名</span><br><span class="line">#更改库的字符集</span><br><span class="line">alter database 库名 character set gbk;</span><br><span class="line">#删除</span><br><span class="line">drop database if exists 库名</span><br></pre></td></tr></table></figure>



<h5 id="二、表的管理"><a href="#二、表的管理" class="headerlink" title="二、表的管理"></a>二、表的管理</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#创建：create</span><br><span class="line">create table 表名（</span><br><span class="line">列名 数据类型 【长度 约束】，</span><br><span class="line">列名 数据类型 【长度 约束】，</span><br><span class="line">...)</span><br><span class="line"></span><br><span class="line">#修改列名、类型、约束、添加列、修改表名：alter</span><br><span class="line">alter table 表名 change column 列名 新列名 数据类型</span><br><span class="line">#类型、约束</span><br><span class="line">alter table 表名 modify column 列名 数据类型</span><br><span class="line">#添加列</span><br><span class="line">alter table 表名 add column 列名 数据类型</span><br><span class="line">#删除列</span><br><span class="line">alter table 表名 drop column 列名</span><br><span class="line">#修改表名</span><br><span class="line">alter table 表名 rename to 新表名</span><br><span class="line"></span><br><span class="line">#删除：drop</span><br><span class="line">drop table if exists 表名</span><br><span class="line"></span><br><span class="line">#复制</span><br><span class="line">#仅复制表的结构</span><br><span class="line">create table 新表名  like 旧表名</span><br><span class="line">#复制表的结构外加数据</span><br><span class="line">create table 新表名</span><br><span class="line">select * from 旧表</span><br></pre></td></tr></table></figure>



<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><blockquote>
<p>数值型：整型、小数（定点、浮点）</p>
<p>字符型：较短的文本char、varchar；较长的：text、blob(较长的二进制数据)</p>
<p>日期型：</p>
</blockquote>
<h5 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h5><p>分类：tinyint、smallint、mediumint、int\integer、bigint</p>
<p>特点：</p>
<ol>
<li>如果不设置有符号还是无符号，那么默认是有符号。若想设置无符号，那么要添加unsigned</li>
<li>若插入的数值超出了整型的范围，会报错out of range</li>
<li>若不设置长度，会有默认长度（当zerofill时有效，会使int成为unsigned,若长度不够，会在左侧填充0）</li>
</ol>
<h5 id="小数"><a href="#小数" class="headerlink" title="小数"></a>小数</h5><p>分类：<br>1.浮点型<br>float(M,D)<br>double(M,D)<br>2.定点型<br>dec(M，D)<br>decimal(M,D)</p>
<p>M：整数部位+小数部位<br>D：小数部位</p>
<p>若小数点位数超过D，则四舍五入；若整数位数超出，则报错。</p>
<h5 id="时间"><a href="#时间" class="headerlink" title="时间"></a>时间</h5><ul>
<li><p>date</p>
<p>MySQL 以 ‘YYYY-MM-DD’ 格式检索与显示date值。支持的范围是 ‘1000-01-01’ 到’9999-12-31’。 </p>
</li>
<li><p>datetime</p>
<p>MySQL 以 ‘YYYY-MM-DD HH:mm:ss’格式检索与显示 DATETIME 类型。支持的范围是’1000-01-0100:00:00’ 到 ‘9999-12-3123:59:59’。(“支持”的含义是，尽管更早的值可能工作，但不能保证他们均可以。) </p>
</li>
</ul>
<h3 id="常见约束"><a href="#常见约束" class="headerlink" title="常见约束"></a>常见约束</h3><p>约束：一种限制，用于限制表中的数据，为了保证数据的准确和可靠性</p>
<p><strong>分类：</strong></p>
<ul>
<li>not null:非空</li>
<li>default：默认，用于保证该字段有默认值</li>
<li>primary key：主键，保证值有唯一性且不为空，一个表中至多有一个主键，但是可以把多个列组合成为一个主键（组合主键）</li>
<li>unique：唯一性但可以为空，<em>至多可以有一个为空</em></li>
<li>check：检查约束（mysql中不支持）</li>
<li>foreign key：外键，用于限制两个表的关系，用于保证该字段的值必须来自于主表的关联列的值，<em>在从表添加外键约束，用于引用主表中某列的值</em></li>
</ul>
<p><strong>约束的添加分类：</strong></p>
<ul>
<li><p>列级约束：<br>六大约束语法上都支持，但外键约束没有效果</p>
</li>
<li><p>表级约束：</p>
<pre><code>除了非空、默认，其他的都支持</code></pre><ul>
<li><p>语法：【constraint 索引名】 约束（列名）</p>
</li>
<li><pre><code>mysql&gt; create table if not exists test(
    -&gt; id int,
    -&gt; stuname varchar(20),
    -&gt; gender char(1),
    -&gt; seat int,
    -&gt; age int 
    -&gt; ,marjorid int,
    -&gt; constraint ok primary key(id),
    -&gt; constraint up unique(seat),
    -&gt; constraint ck check(gender=&apos;男&apos; or gender=&apos;女&apos;)，
    -&gt; constraint pk_test_majorid foreign key(majorid) references major(id)
    -&gt; );

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
CREATE TABLE 表名(
字段名 字段类型 列级约束,
字段名 字段类型,
表级约束
)
</code></pre></li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**外键：**</span><br><span class="line"></span><br><span class="line">1. 要求在从表设置外键关系</span><br><span class="line">2. 从表的外键列的类型和主表的关联列的类型要求一致或兼容，名称无要求</span><br><span class="line">3. 主表的被引用列必须是一个key（一般是主键或唯一） </span><br><span class="line">4. 插入数据时，先插入主表，再插入从表；删除时，先从表再主表</span><br></pre></td></tr></table></figure>
<p>删除主表中记录的方法（很少使用）：<br>#1、级联删除<br>alter table stuinfo add constraint fk_stu_major foreign key(majorid) references major(id) on delete cascade</p>
<p>#2、级联置空<br>alter table stuinfo add constraint fk_stu_major foreign key(majorid) references major(id) on delete set null</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">**删除约束**</span><br><span class="line"></span><br><span class="line">1.删除非空约束</span><br><span class="line">ALTER TABLE stuinfo MODIFY COLUMN stuname VARCHAR(20) NULL;</span><br><span class="line">2.删除默认约束</span><br><span class="line">ALTER TABLE stuinfo MODIFY COLUMN age INT ;</span><br><span class="line">3.删除主键</span><br><span class="line">ALTER TABLE stuinfo DROP PRIMARY KEY;</span><br><span class="line">4.删除唯一</span><br><span class="line">ALTER TABLE stuinfo DROP INDEX up;</span><br><span class="line">5.删除外键</span><br><span class="line">ALTER TABLE stuinfo DROP FOREIGN KEY 索引名</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 标识列（自增长列）</span><br><span class="line"></span><br><span class="line">**特点：**</span><br><span class="line"></span><br><span class="line">+ 标识列必须与key搭配</span><br><span class="line">+ &#x3D;&#x3D;一个表至多一个标识列&#x3D;&#x3D;</span><br><span class="line">+ 标识列的类型必须是数值型</span><br><span class="line">+ 可以通过set auto_increment_increment&#x3D;3,修改步长为3</span><br><span class="line"></span><br><span class="line">**定义标识列的方法**</span><br><span class="line"></span><br><span class="line">1. 创建表时，设置标识列（auto_increment）</span><br><span class="line"></span><br><span class="line">2. 修改表时设置标识列</span><br><span class="line"></span><br><span class="line">   &#96;alter table test modify column id int auto_increment;&#96;</span><br><span class="line"></span><br><span class="line">3. 修改表时删除标识列</span><br><span class="line"></span><br><span class="line">   &#96;alter table test modify column id int;&#96;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 事务（TCL：事务控制语言)</span><br><span class="line"></span><br><span class="line">事务：一个或一组sql语言组成一个执行单元，这个执行单元要么全部执行，要么全部不执行。</span><br><span class="line"></span><br><span class="line">回滚：撤销之前的操作</span><br><span class="line"></span><br><span class="line">**事务的ACID属性：**</span><br><span class="line"></span><br><span class="line">+ 原子性（aotmicity):事务是一个不可分割的工作单位，要么都执行要么都不执行</span><br><span class="line">+ 一致性（consistency）：使数据库从一个一致性状态变换到另一个一致性状态。</span><br><span class="line">+ 隔离性（isolation）：一个事务的不行不受其他事务干扰</span><br><span class="line">+ 持久性（durability）：一个事务一旦被提交，那么它对数据库中的数据的改变就是永久性的。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">**事务的创建**</span><br><span class="line"></span><br><span class="line">+ 隐式事务：没有明显的开始和结束的标记；insert,update,delete</span><br><span class="line"></span><br><span class="line">+ 显示事务：有明显的开始和结束的标记</span><br><span class="line"></span><br><span class="line">  ​                 必须先设置自动提交功能为禁用（set autocommit&#x3D;0)</span><br></pre></td></tr></table></figure>
<p>  1、开启事务<br>  set autocommit=0；<br>  start transaction;可省略<br>  2、编写sql语句<br>  支持update，insert、delete<br>  create没有效果<br>  …</p>
<p>  设置回滚点</p>
<p>  3、结束事务<br>  commit;提交事务<br>  rollback;回滚事务<br>  rollback to 回滚点</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**并发事务**</span><br><span class="line"></span><br><span class="line">1. 并发问题如何发生的？</span><br><span class="line"></span><br><span class="line">   多个事务同时操作同一个数据库的相同数据时</span><br><span class="line"></span><br><span class="line">2. 常见的事务并发问题</span><br><span class="line"></span><br><span class="line">+ 脏读：  一个事务读取了其他事务还没有提交的数据，读到的是其他事务“更新”的数据</span><br><span class="line">+ 不可重复读：一个事务多次读取，结果不一样</span><br><span class="line">+ 幻读:  一个事务读取了其他事务还没有提交的数据，只是读到的是其他事务“插入”的数据</span><br><span class="line"></span><br><span class="line">3. 如何解决并发问题？</span><br><span class="line"></span><br><span class="line">   通过设置隔离级别解决并发问题</span><br><span class="line"></span><br><span class="line">**隔离级别**</span><br><span class="line"></span><br><span class="line">+  read uncommitted：出现脏读、不可重复读和幻读</span><br><span class="line">+  read committed:若事务未提交，那么读到的数据依旧是未更改前的，避免了脏读</span><br><span class="line">+  repeatable read:：避免了脏读和不可重复读</span><br><span class="line">+  serializable:避免了脏读、不可重复读和幻读（使用较少，因为效率低下）</span><br><span class="line"></span><br><span class="line">&lt;u&gt;mysql中默认第三个隔离级别repeatable read&lt;&#x2F;u&gt;</span><br><span class="line"></span><br><span class="line">**设置隔离级别**</span><br><span class="line"></span><br><span class="line">设置当前连接的隔离级别：set session transaction isolation level ...</span><br><span class="line"></span><br><span class="line">设置全局的隔离级别：set global session transaction isolation level ...</span><br><span class="line"></span><br><span class="line">查看隔离级别：select @@transaction_isolation</span><br><span class="line"></span><br><span class="line">&lt;img src&#x3D;&quot;  http:&#x2F;&#x2F;www.yelin.monster&#x2F;pictures&#x2F;1573992654421.png&quot;&#x2F;&gt;</span><br><span class="line"></span><br><span class="line">**savepoint**</span><br></pre></td></tr></table></figure>
<p>set autocommit=0;<br>start transaction;<br>delete from beauty where id=17;<br>savepoint a;<br>delete from beauty where id=18;<br>rollback to a;</p>
<p>#删除了17，没删除18</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**delete和trancate在事务使用的区别**</span><br><span class="line"></span><br><span class="line">&#x3D;&#x3D;delete支持回滚而trancate不支持回滚&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 视图（虚拟表）</span><br><span class="line"></span><br><span class="line">视图：是通过表动态生成的数据，只保存了sql逻辑，不保存查询结果（sql5.1的新特性）</span><br><span class="line"></span><br><span class="line">好处：</span><br><span class="line"></span><br><span class="line">1. 重用sql语句</span><br><span class="line">2. 简化了复杂的sql操作，不必知道它的查询细节</span><br><span class="line">3. 保护数据，提高安全性</span><br><span class="line"></span><br><span class="line">**创建视图**</span><br></pre></td></tr></table></figure>
<p>create view 视图名<br>as<br>查询语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">**视图的修改**</span><br></pre></td></tr></table></figure>
<p>#1<br>create or replace voew  视图名<br>as<br>查询语句</p>
<p>#2<br>alter view 视图名<br>as<br>查询语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">**删除和查看视图**</span><br></pre></td></tr></table></figure>
<p>#删除<br>drop view 视图名，视图名…</p>
<p>#查看<br>desc 视图名;<br>show create view 视图名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x3D;&#x3D;在视图中插入或修改值会对原始表有影响，不太安全&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">具备以下特点的视图不允许更新：</span><br><span class="line"></span><br><span class="line">+ 包含以下关键字的sql语句：分组函数、distinct、group  by、having、union或者union all</span><br><span class="line">+ 常量视图</span><br><span class="line">+ where后的子查询用到了from中的表</span><br><span class="line">+ join</span><br><span class="line">+ from一个不能更新的视图</span><br><span class="line"></span><br><span class="line">**表和视图的对比**</span><br><span class="line"></span><br><span class="line">|      | 创建语法的关键字 | 是否实际占用物理空间    | 使用                         |</span><br><span class="line">| ---- | ---------------- | ----------------------- | ---------------------------- |</span><br><span class="line">| 视图 | create view      | 没有，只是保存了sql逻辑 | 增删改查，一般不能使用增删改 |</span><br><span class="line">| 表   | create table     | 占用                    | 增删改查                     |</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 变量</span><br><span class="line"></span><br><span class="line">+ 系统变量：变量由系统提供，属于服务器层面</span><br></pre></td></tr></table></figure>
<p>  #查看变量<br>  show [global|session] variables<br>  #查看满足条件的部分系统变量<br>  show [global|session] variables like “  “;<br>  #查看指定的系统变量<br>  select @@global|session.系统变量名<br>  #为某个系统变量赋值<br>  1、set global|session.变量名=值<br>  2、set @@global|session.变量名=值</p>
<p>  变量默认是session级别（会话）的</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  + 全局变量</span><br><span class="line"></span><br><span class="line">    对所有连接有效</span><br><span class="line"></span><br><span class="line">  + 会话变量</span><br><span class="line"></span><br><span class="line">    仅仅对当前连接有效</span><br><span class="line"></span><br><span class="line">+ 自定义变量</span><br><span class="line"></span><br><span class="line">  步骤：声明、赋值、使用</span><br><span class="line"></span><br><span class="line">  + 用户变量</span><br><span class="line"></span><br><span class="line">    作用域：同于会话变量的作用域</span><br><span class="line"></span><br><span class="line">    应用在任何地方</span><br></pre></td></tr></table></figure>
<pre><code>#赋值操作符：=或:=
#①声明并初始化
SET @变量名=值;
SET @变量名:=值;
SELECT @变量名:=值;

#②赋值（更新变量的值）
#方式一：
    SET @变量名=值;
    SET @变量名:=值;
    SELECT @变量名:=值;
#方式二：
    SELECT 字段 INTO @变量名
    FROM 表;
#③使用（查看变量的值）
SELECT @变量名;


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">+ 局部变量</span><br><span class="line"></span><br><span class="line">  作用域：仅仅在定义它的begin end块中有效</span><br><span class="line">  应用在 begin end中的第一句话</span><br></pre></td></tr></table></figure>
#①声明(必须指定数据类型)
DECLARE 变量名 类型;
DECLARE 变量名 类型 【DEFAULT 值】;


#②赋值（更新变量的值）

#方式一：
    SET 局部变量名=值;
    SET 局部变量名:=值;
    SELECT 局部变量名:=值;
#方式二：
    SELECT 字段 INTO 局部变量名
    FROM 表;
#③使用（查看变量的值）
SELECT 局部变量名;

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  对比用户变量和局部变量：</span><br><span class="line"></span><br><span class="line">|          | 作用域      | 定义和使用的位置                | 语法                      |</span><br><span class="line">| -------- | ----------- | ------------------------------- | ------------------------- |</span><br><span class="line">| 用户变量 | 当前会话    | 会话的任何地方                  | 必须加@，不用限定类型     |</span><br><span class="line">| 局部变量 | begin end中 | 只能在begin end中，且为第一句话 | 一般不用加@，需要限定类型 |</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 存储过程和函数</span><br><span class="line"></span><br><span class="line">存储过程：一组预先编译好的sql语句的集合，理解成批处理语句（提高了效率，减少了编译次数和数据库服务器的连接次数）</span><br></pre></td></tr></table></figure></code></pre><p>#创建语法<br>create procedure 存储过程（参数列表）<br>begin<br>    存储过程体（一组合法的sql语句）<br>end</p>
<p>#调用语法<br>call 存储过程名（实参列表）；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">注意：</span><br><span class="line"></span><br><span class="line">1. 参数列表包含三部分：参数模式（in,out,inout）、参数名、参数类型</span><br><span class="line"></span><br><span class="line">   1. in：该参数可以作为输入，也就是该参数需要调入方传入值</span><br><span class="line">   2. out:该参数可以作为输出，也就是该参数可以作为返回值</span><br><span class="line">   3. inout：该参数可以作为输入也可以作为输入，也就是该参数既需要调入方传入值，又可以返回值</span><br><span class="line"></span><br><span class="line">2. 如果存储体只有一句话，begin end 可以省略</span><br><span class="line"></span><br><span class="line">   存储过程体的每条sql语句结尾必须加分号，存储体过程的结尾可以用delimiter重新设置</span><br></pre></td></tr></table></figure>
<p>   #delimiter 结束标记<br>   delimiter $</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">实例：</span><br><span class="line"></span><br><span class="line">&#96;</span><br></pre></td></tr></table></figure>
<p>   #空参<br>   delimiter $<br>   create procedure myp1()<br>   begin<br>       insert into beauty(id,name,phone)<br>       values(19,’fsgser’,null),(20,’gfkjsa’,null);<br>   end $</p>
<p>   ````</p>
<p>#####in模式</p>
<p>   create procedure myp2(in beautyname varchar（20）)<br>   begin<br>   …<br>   end</p>
<p>   call myp2(‘张三’)</p>
<p>#####out模式</p>
<h1 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h1><h3 id="随机获取50条记录"><a href="#随机获取50条记录" class="headerlink" title="随机获取50条记录"></a>随机获取50条记录</h3><p>select * from question_choice where q_id&gt;=<br>((select max(q_id) from question_choice)-(select min(q_id) from question_choice))*rand() +(select min(q_id) from question_choice) limit 50;</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">xxxuxonezero</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://xxxuxonezero.github.io/2019/12/11/%E6%95%B0%E6%8D%AE%E5%BA%93/">https://xxxuxonezero.github.io/2019/12/11/%E6%95%B0%E6%8D%AE%E5%BA%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://xxxuxonezero.github.io" target="_blank">onezero</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div><div class="post_share"><div class="social-share" data-image="/img/81496502_p0_master1200.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付宝"/><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/05/13/127-0-0-1%E9%97%AE%E9%A2%98/"><img class="prev_cover" data-src="http://www.yelin.monster/pictures/timg.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">v2ray出现can't bind to 127.0.0.1问题</div></div></a></div><div class="next-post pull_right"><a href="/2019/10/16/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94KNN%E5%88%86%E7%B1%BB%E7%AE%97%E6%B3%95/"><img class="next_cover" data-src="http://www.yelin.monster/pictures/knn.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">机器学习——KNN分类算法</div></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
var requiredFields = requestSetting(['nick','mail','link'],'nick')

window.valine = new Valine({
  el:'#vcomment',
  appId: 'i0fGyWuvMkNazHg0P2N6uJgs-gzGzoHsz',
  appKey: 'tuRDHDWBSg4sivE44GoiRNsK',
  notify: false,
  verify: false,
  placeholder: '欢迎留下足迹噢*^____^*',
  avatar: 'retro',
  meta: guestInfo,
  pageSize: '10',
  lang: 'zh-CN',
  recordIP: false,
  serverURLs: '',
  emojiCDN: '//i0.hdslb.com/bfs/emote/',
  emojiMaps: {"tv_doge":"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","tv_亲亲":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png","tv_偷笑":"bb690d4107620f1c15cff29509db529a73aee261.png","tv_再见":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","tv_冷漠":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","tv_发怒":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","tv_发财":"34db290afd2963723c6eb3c4560667db7253a21a.png","tv_可爱":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","tv_吐血":"09dd16a7aa59b77baa1155d47484409624470c77.png","tv_呆":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png","tv_呕吐":"9f996894a39e282ccf5e66856af49483f81870f3.png","tv_困":"241ee304e44c0af029adceb294399391e4737ef2.png","tv_坏笑":"1f0b87f731a671079842116e0991c91c2c88645a.png","tv_大佬":"093c1e2c490161aca397afc45573c877cdead616.png","tv_大哭":"23269aeb35f99daee28dda129676f6e9ea87934f.png","tv_委屈":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","tv_害羞":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png","tv_尴尬":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png","tv_微笑":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","tv_思考":"90cf159733e558137ed20aa04d09964436f618a1.png","tv_惊吓":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png"},
  enableQQ: false,
  requiredFields: requiredFields
});</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By xxxuxonezero</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script src="/js/third-party/ClickShowText.js"></script><script src="/js/search/algolia.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/miku.model.json"},"log":false});</script></body></html>